<?xml version="1.0" encoding="utf-8"?><asx:abap version="1.0" xmlns:asx="http://www.sap.com/abapxml"><asx:values><VERSION>1</VERSION><TYPE/><INTERFACE href="#o2075"/><INTERFACET/></asx:values><asx:heap xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:abap="http://www.sap.com/abapxml/types/built-in" xmlns:cls="http://www.sap.com/abapxml/classes/global" xmlns:dic="http://www.sap.com/abapxml/types/dictionary"><cls:CL_FP_INTERFACE_DATA id="o2075"><CL_FP_INTERFACE_DATA classVersion="1"><CODING href="#o2071"/><PARAMETERS href="#o2072"/><GLOBAL_DEFINITIONS href="#o2073"/><REFERENCE_FIELDS href="#o2074"/><XSD_DEFINITIONS/></CL_FP_INTERFACE_DATA></cls:CL_FP_INTERFACE_DATA><cls:CL_FP_REFERENCE_FIELDS id="o2074"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o2075"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_REFERENCE_FIELDS classVersion="1"><REFERENCE_FIELDS><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>CONDITIONS-KBETR</VALUE><UNIT>CONDITIONS-KOEI1</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>ITEM-MENGE</VALUE><UNIT>ITEM-MEINS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>SCHEDULE-MENGE</VALUE><UNIT>ITEM-MEINS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>COMPONENTSHDR-TLMNG</VALUE><UNIT>COMPONENTSHDR-LAGME</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>COMPONENTSHDR-AVMNG</VALUE><UNIT>COMPONENTSHDR-LAGME</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>COMPONENTSHDR-WAMNG</VALUE><UNIT>COMPONENTSHDR-LAGME</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>COMPONENTSHDR-WEMNG</VALUE><UNIT>COMPONENTSHDR-LAGME</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>COMPONENTS-BDMNG</VALUE><UNIT>COMPONENTS-LAGME</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>ITEM-NETPR</VALUE><UNIT>HEADER-WAERS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>ITEM-NETWR</VALUE><UNIT>HEADER-WAERS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>KOMK-FKWRT</VALUE><UNIT>HEADER-WAERS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>KOMK-SUPOS</VALUE><UNIT>HEADER-WAERS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>KOMK-FKWRT_EURO</VALUE><UNIT>HEADER-WAERS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>ACCOUNT-MENGE</VALUE><UNIT>ITEM-MEINS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>ITEM-WEMNG</VALUE><UNIT>ITEM-MEINS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>ITEM-BSMNG</VALUE><UNIT>ITEM-BPRME</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>QUAN</DATATYPE><VALUE>SRVLINES-MENGE</VALUE><UNIT>SRVLINES-MEINS</UNIT></SFPREF><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>SRVCONDITIONS-KBETR</VALUE><UNIT>SRVCONDITIONS-KOEI1</UNIT></SFPREF></REFERENCE_FIELDS></CL_FP_REFERENCE_FIELDS></cls:CL_FP_REFERENCE_FIELDS><cls:CL_FP_GLOBAL_DEFINITIONS id="o2073"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o2075"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_GLOBAL_DEFINITIONS classVersion="1"><GLOBAL_DATA><SFPGDATA><NAME>GV_TIMBRE</NAME><TYPING>TYPE</TYPING><TYPENAME>BRTWR</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_AUTORIZADOR</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_NOTAS_IMP_TTL</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_ERNAM</NAME><TYPING>TYPE</TYPING><TYPENAME>AD_NAMTEXT</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_ANTICOR</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_CUMPLIM</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_ACEPTAC</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_DIR_ENT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_DIR_ENT</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_OBSRV</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_FACT_DAT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_FACT_DAT</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_SUBTOT</NAME><TYPING>TYPE</TYPING><TYPENAME>BRTWR</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_IVA</NAME><TYPING>TYPE</TYPING><TYPENAME>BRTWR</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_TOTAL</NAME><TYPING>TYPE</TYPING><TYPENAME>BRTWR</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GT_DPOS</NAME><TYPING>TYPE</TYPING><TYPENAME>ZTT_STR_DPOS_OC</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_LFNR_ADRC</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_LFNR_ADRC</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_HRA</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_HRA</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_HRB</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_HRB</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_HLB</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_HLB</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_DEMP</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_DEMP</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_PAVAL</NAME><TYPING>TYPE</TYPING><TYPENAME>PAVAL</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_ADRC</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_ADRC</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GS_T001</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_T001</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_OBS</NAME><TYPING>TYPE</TYPING><TYPENAME>STRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_SWITCH</NAME><TYPING>TYPE</TYPING><TYPENAME>BOOLEAN</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA></GLOBAL_DATA><TYPES><FPCLINE>TYPES: BEGIN OF ty_t001,</FPCLINE><FPCLINE>         butxt TYPE t001-butxt, "Denominación de la sociedad"</FPCLINE><FPCLINE>         adrnr TYPE t001-adrnr, "Dirección"</FPCLINE><FPCLINE>         ort01 TYPE t001-ort01, "Población"</FPCLINE><FPCLINE>       END OF ty_t001,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_adrc,</FPCLINE><FPCLINE>         street     TYPE adrc-street,          "Dirección</FPCLINE><FPCLINE>         tel_number TYPE adrc-tel_number,      "Teléfono</FPCLINE><FPCLINE>         name1      TYPE adrc-name1,           "Nombre 1</FPCLINE><FPCLINE>         name2      TYPE adrc-name2,           "Nombre 2</FPCLINE><FPCLINE>       END OF ty_adrc,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_demp,</FPCLINE><FPCLINE>         butxt(81)  TYPE c,                "Nombre de la empresa"</FPCLINE><FPCLINE>         street     TYPE adrc-street,      "Dirección</FPCLINE><FPCLINE>         ort01      TYPE t001-ort01,       "Población</FPCLINE><FPCLINE>         tel_number TYPE string,           "ADRC-TEL_NUMBER, Teléfono</FPCLINE><FPCLINE>         paval      TYPE string,           "T001Z-PAVAL, Nit</FPCLINE><FPCLINE>       END OF ty_demp,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_hra,</FPCLINE><FPCLINE>         ebeln(16) TYPE c,        "Nro. Orden de compra</FPCLINE><FPCLINE>         aedat     TYPE string,       "Fecha de emisión oc</FPCLINE><FPCLINE>         eindt     TYPE string,       "Fecha de entrega</FPCLINE><FPCLINE>         lipre     TYPE lfm1-lipre,   "% de comisión</FPCLINE><FPCLINE>       END OF ty_hra,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_hrb,</FPCLINE><FPCLINE>         waers TYPE ekko-waers,   "Moneda</FPCLINE><FPCLINE>         condp TYPE string,       "Condición de pago</FPCLINE><FPCLINE>         wkurs TYPE ekko-wkurs,   "Tasa de cambio</FPCLINE><FPCLINE>         verkf TYPE ekko-verkf,   "Persona de contacto</FPCLINE><FPCLINE>         telf1 TYPE ekko-telf1,</FPCLINE><FPCLINE>       END OF ty_hrb,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_hlb,</FPCLINE><FPCLINE>         name1 TYPE lfa1-name1,      "Proveedor</FPCLINE><FPCLINE>         lifnr TYPE ekko-lifnr,      "Código interno</FPCLINE><FPCLINE>         mcstr TYPE adrc-mc_street,  "Calle</FPCLINE><FPCLINE>         cd_cp TYPE string,          "Ciudad - Código postal</FPCLINE><FPCLINE>         telf1 TYPE lfa1-telf1,      "Teléfono</FPCLINE><FPCLINE>         stcd1 TYPE lfa1-stcd1,      "Nit</FPCLINE><FPCLINE>       END OF ty_hlb,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_lfnr_adrc,</FPCLINE><FPCLINE>         mc_street  TYPE adrc-mc_street,</FPCLINE><FPCLINE>         city1      TYPE adrc-city1,</FPCLINE><FPCLINE>         post_code1 TYPE adrc-post_code1,</FPCLINE><FPCLINE>       END OF ty_lfnr_adrc,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_dir_ent,</FPCLINE><FPCLINE>         name2  TYPE t001w-name2,</FPCLINE><FPCLINE>         street TYPE char100, "ADRC-STREET,</FPCLINE><FPCLINE>       END OF ty_dir_ent,</FPCLINE><FPCLINE/><FPCLINE>       BEGIN OF ty_fact_dat,</FPCLINE><FPCLINE>         butxt(81) TYPE c,</FPCLINE><FPCLINE>         street    TYPE adrc-street,</FPCLINE><FPCLINE>         paval     TYPE t001z-paval,</FPCLINE><FPCLINE>       END OF ty_fact_dat.</FPCLINE></TYPES><FIELDSYMBOLS/></CL_FP_GLOBAL_DEFINITIONS></cls:CL_FP_GLOBAL_DEFINITIONS><cls:CL_FP_PARAMETERS id="o2072"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o2075"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_PARAMETERS classVersion="1"><IMPORT_PARAMETERS><SFPIOPAR><NAME>SHIPINSTR</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_T027B</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>DOCUMENTS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_DRAD</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>COMPONENTSHDR</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_COMPLIST_HDR</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>COMPONENTS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_COMPLIST</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>MANFDETAILS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_HTNMAT</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SCHEDULE</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKET</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SERVICES</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_ML_ESLL</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>HEADER</NAME><TYPING>TYPE</TYPING><TYPENAME>MMPUR_PRINT_EKKO</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>APPENDIXTEXT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_T166A</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>HEADERINFO</NAME><TYPING>TYPE</TYPING><TYPENAME>T166U</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>ADDRESSINFO</NAME><TYPING>TYPE</TYPING><TYPENAME>T024E</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVTEXT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_T166P</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVVALUE</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_ESUH</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>MAINTHDR</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_MMPT</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>MAINTPOS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MPOS</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>FORMULABODY</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_VARIABLEN</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVLINES</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_SRVLINE</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>MMPUR_PRINT_ML_ESLL</NAME><TYPING>TYPE</TYPING><TYPENAME>MMPUR_PRINT_ML_ESLL</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>EKKO</NAME><TYPING>TYPE</TYPING><TYPENAME>EKKO</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CHANGETEXT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_T166T</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>INVOICEPER</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_FPLTDR_PER</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>INVOICEVAL</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_FPLTDR_VAL</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>MODE</NAME><TYPING>TYPE</TYPING><TYPENAME>DRUVO</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>PAYMENTTERMS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_TTEXT</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>HEADERTEXT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_T166K</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CONTACTINFO</NAME><TYPING>TYPE</TYPING><TYPENAME>T024</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>VARIANTS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_PEKPOV</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>KOMK</NAME><TYPING>TYPE</TYPING><TYPENAME>MMPUR_PRINT_KOMK</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVCONDITIONS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_KOMVD</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>QMTEXT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_QMTEXT</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CONDITIONS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_KOMVD</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>INVOICE</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_FPLTDR</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>FORMULAHDR</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_FORMEL</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>ACCOUNT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_EKKN</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVTYP</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_SRVTYP</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>ITEM</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKPO</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVHDR</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_SRVHDR</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CONFIGMAT</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_ECONF_OUT</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SRVTIME</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_TIME</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CHNGTXTSRV</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_T166T</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>ITEMLINE</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_ITEM</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>EKPO</NAME><TYPING>TYPE</TYPING><TYPENAME>EKPO</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>TEXTS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_T166P</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CONTCONDITIONS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKOMD</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>QUANCONDITIONS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKOMD_QUANT</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>VALUECONDITIONS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKOMD_VALUE</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>LINECONDITIONS</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKOMD_COND</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>EKEK</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_EKEK</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SCHEDLINES</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_MMPUR_PRINT_SCHEDLINE</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>ACCQTYFLG</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR01</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE/><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>REASON_FOR_REJECTION</NAME><TYPING>TYPE</TYPING><TYPENAME>T165M</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>SERIALNUMBER</NAME><TYPING>TYPE</TYPING><TYPENAME>PRINT_OBJK_SERIALNO</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE/><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>XFZ</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR01</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR><SFPIOPAR><NAME>CONDITIONS_HDR</NAME><TYPING>TYPE</TYPING><TYPENAME>TY_KOMVD</TYPENAME><OPTIONAL>X</OPTIONAL><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR></IMPORT_PARAMETERS><EXPORT_PARAMETERS/><TABLE_PARAMETERS/><EXCEPTIONS/></CL_FP_PARAMETERS></cls:CL_FP_PARAMETERS><cls:CL_FP_CODING id="o2071"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o2075"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_CODING classVersion="1"><INPUT_PARAMETERS><FPPARAMETER>GV_OBS</FPPARAMETER><FPPARAMETER>GV_NOTAS_IMP_TTL</FPPARAMETER><FPPARAMETER>GV_ERNAM
</FPPARAMETER><FPPARAMETER>GV_ANTICOR</FPPARAMETER><FPPARAMETER>GV_CUMPLIM</FPPARAMETER><FPPARAMETER>GV_ACEPTAC</FPPARAMETER><FPPARAMETER>GS_DIR_ENT</FPPARAMETER><FPPARAMETER>GV_OBSRV</FPPARAMETER><FPPARAMETER>GS_FACT_DAT</FPPARAMETER><FPPARAMETER>GV_SUBTOT</FPPARAMETER><FPPARAMETER>GV_IVA</FPPARAMETER><FPPARAMETER>GV_TOTAL</FPPARAMETER><FPPARAMETER>GT_DPOS</FPPARAMETER><FPPARAMETER>GS_LFNR_ADRC</FPPARAMETER><FPPARAMETER>GS_HRB</FPPARAMETER><FPPARAMETER>GS_HLB</FPPARAMETER><FPPARAMETER>GS_DEMP</FPPARAMETER><FPPARAMETER>GV_PAVAL</FPPARAMETER><FPPARAMETER>GS_ADRC</FPPARAMETER><FPPARAMETER>GS_T001</FPPARAMETER></INPUT_PARAMETERS><OUTPUT_PARAMETERS><FPPARAMETER>GV_TIMBRE</FPPARAMETER><FPPARAMETER>GV_AUTORIZADOR</FPPARAMETER><FPPARAMETER>GV_OBS</FPPARAMETER><FPPARAMETER>GV_NOTAS_IMP_TTL</FPPARAMETER><FPPARAMETER>GV_ERNAM</FPPARAMETER><FPPARAMETER>GV_ANTICOR</FPPARAMETER><FPPARAMETER>GV_CUMPLIM</FPPARAMETER><FPPARAMETER>GV_ACEPTAC</FPPARAMETER><FPPARAMETER>GS_DIR_ENT</FPPARAMETER><FPPARAMETER>GV_OBSRV</FPPARAMETER><FPPARAMETER>GS_FACT_DAT</FPPARAMETER><FPPARAMETER>GV_SUBTOT</FPPARAMETER><FPPARAMETER>GV_IVA</FPPARAMETER><FPPARAMETER>GV_TOTAL</FPPARAMETER><FPPARAMETER>GT_DPOS</FPPARAMETER><FPPARAMETER>GS_LFNR_ADRC</FPPARAMETER><FPPARAMETER>GS_HRA</FPPARAMETER><FPPARAMETER>GS_HRB</FPPARAMETER><FPPARAMETER>GS_HLB</FPPARAMETER><FPPARAMETER>GS_DEMP</FPPARAMETER><FPPARAMETER>GV_PAVAL</FPPARAMETER><FPPARAMETER>GS_ADRC</FPPARAMETER><FPPARAMETER>GS_T001</FPPARAMETER></OUTPUT_PARAMETERS><INITIALIZATION><FPCLINE>DATA: lv_output   TYPE string,</FPCLINE><FPCLINE>      ls_dpos     TYPE zsd_str_dpos_oc,</FPCLINE><FPCLINE>      lv_id       TYPE thead-tdid,</FPCLINE><FPCLINE>      lt_lines    TYPE STANDARD TABLE OF tline,</FPCLINE><FPCLINE>      ls_lines    LIKE LINE OF lt_lines,</FPCLINE><FPCLINE>      lv_name     TYPE thead-tdname,</FPCLINE><FPCLINE>      lv_uniqueid TYPE ekpo-uniqueid,</FPCLINE><FPCLINE>      lv_aufnr    TYPE ekkn-aufnr,</FPCLINE><FPCLINE>      lv_ktext    TYPE coas-ktext,</FPCLINE><FPCLINE>      lv_kbetr    TYPE kbetr.        "importe o porcentaje de la cond</FPCLINE><FPCLINE/><FPCLINE>DATA: lv_werks_flag TYPE i,</FPCLINE><FPCLINE>      lv_werks      TYPE werks_d.</FPCLINE><FPCLINE/><FPCLINE>*BREAK mqa_abap3.</FPCLINE><FPCLINE>*BREAK gmolina.</FPCLINE><FPCLINE/><FPCLINE>* Check the Segmentation switch</FPCLINE><FPCLINE>CALL METHOD cl_ops_switch_check=&gt;sfsw_segmentation</FPCLINE><FPCLINE>  RECEIVING</FPCLINE><FPCLINE>    rv_active = gv_switch.</FPCLINE><FPCLINE>IF gv_switch NE 'X'.</FPCLINE><FPCLINE>  CLEAR gv_switch.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>DATA: lv_bukrs TYPE ekko-bukrs.</FPCLINE><FPCLINE/><FPCLINE>*--- inicio del proceso</FPCLINE><FPCLINE>*--- sociedad</FPCLINE><FPCLINE>lv_bukrs = header-bukrs.</FPCLINE><FPCLINE/><FPCLINE>*--- se maneja la excepción con la sociedad cuando el tipo de</FPCLINE><FPCLINE>*--- pedido es de publicidad</FPCLINE><FPCLINE>IF header-bsart EQ 'ZPUB'.</FPCLINE><FPCLINE>  lv_bukrs = '1070'.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- obtengo los datos de la empresa tomando en cuenta</FPCLINE><FPCLINE>*--- la excepción con la sociedad</FPCLINE><FPCLINE>CLEAR: gs_t001, gs_adrc, gv_paval.</FPCLINE><FPCLINE>PERFORM f_get_dat_emp USING lv_bukrs</FPCLINE><FPCLINE>                   CHANGING gs_t001</FPCLINE><FPCLINE>                            gs_adrc</FPCLINE><FPCLINE>                            gv_paval.</FPCLINE><FPCLINE/><FPCLINE>*--- Se completan los datos de la empresa</FPCLINE><FPCLINE>gs_demp-butxt = |{ gs_adrc-name1 } { space } { gs_adrc-name2 }|.</FPCLINE><FPCLINE>gs_demp-street = gs_adrc-street.</FPCLINE><FPCLINE>gs_demp-ort01 = gs_t001-ort01.</FPCLINE><FPCLINE/><FPCLINE>CONCATENATE 'PBX' gs_adrc-tel_number INTO gs_demp-tel_number</FPCLINE><FPCLINE>SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>CONCATENATE 'NIT.' gv_paval INTO gs_demp-paval</FPCLINE><FPCLINE>SEPARATED BY space.</FPCLINE><FPCLINE/><FPCLINE>*--- se llenan datos de cabeceras de la derecha</FPCLINE><FPCLINE>*--- GS_HRA</FPCLINE><FPCLINE>*--- orden de compras nro</FPCLINE><FPCLINE>gs_hra-ebeln = |{ header-bsart } { space } { header-ebeln }|.</FPCLINE><FPCLINE/><FPCLINE>*--- fecha de emision de la oc</FPCLINE><FPCLINE>CLEAR lv_output.</FPCLINE><FPCLINE>CALL FUNCTION 'CONVERSION_EXIT_LDATE_OUTPUT'</FPCLINE><FPCLINE>  EXPORTING</FPCLINE><FPCLINE>    input  = header-aedat</FPCLINE><FPCLINE>  IMPORTING</FPCLINE><FPCLINE>    output = lv_output.</FPCLINE><FPCLINE/><FPCLINE>gs_hra-aedat = lv_output.</FPCLINE><FPCLINE/><FPCLINE>*--- fecha de entrega</FPCLINE><FPCLINE>SELECT SINGLE eindt</FPCLINE><FPCLINE>  INTO @DATA(lv_eindt)</FPCLINE><FPCLINE>  FROM eket</FPCLINE><FPCLINE>  WHERE ebeln = @header-ebeln.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  CLEAR lv_output.</FPCLINE><FPCLINE>  CALL FUNCTION 'CONVERSION_EXIT_LDATE_OUTPUT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      input  = lv_eindt</FPCLINE><FPCLINE>    IMPORTING</FPCLINE><FPCLINE>      output = lv_output.</FPCLINE><FPCLINE/><FPCLINE>  gs_hra-eindt = lv_output.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- porcentaje de comisión agencia</FPCLINE><FPCLINE>SELECT SINGLE lipre</FPCLINE><FPCLINE>  INTO @DATA(lv_lipre)</FPCLINE><FPCLINE>  FROM lfm1</FPCLINE><FPCLINE>  WHERE lifnr = @header-lifnr AND</FPCLINE><FPCLINE>        ekorg = @header-ekorg.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  gs_hra-lipre = lv_lipre.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- GS_HRB</FPCLINE><FPCLINE>*--- moneda</FPCLINE><FPCLINE>gs_hrb-waers = header-waers.</FPCLINE><FPCLINE/><FPCLINE>*--- Condición de pago</FPCLINE><FPCLINE>SELECT SINGLE ztag1</FPCLINE><FPCLINE>  INTO @DATA(lv_ztag1)</FPCLINE><FPCLINE>  FROM t052</FPCLINE><FPCLINE>  WHERE zterm = @header-zterm.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  CONCATENATE lv_ztag1+1(2) 'DIAS' INTO gs_hrb-condp</FPCLINE><FPCLINE>  SEPARATED BY space.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- Tasa de cambio</FPCLINE><FPCLINE>gs_hrb-wkurs = header-wkurs.</FPCLINE><FPCLINE/><FPCLINE>*--- persona de contacto</FPCLINE><FPCLINE>gs_hrb-verkf = header-verkf.</FPCLINE><FPCLINE/><FPCLINE>*--- teléfono</FPCLINE><FPCLINE>gs_hrb-telf1 = header-telf1.</FPCLINE><FPCLINE/><FPCLINE>*--- se llenan datos de cabecera de la izquierda</FPCLINE><FPCLINE>*GS_HLB</FPCLINE><FPCLINE>*--- Proveedor</FPCLINE><FPCLINE>SELECT SINGLE name1</FPCLINE><FPCLINE>  INTO @DATA(lv_name1)</FPCLINE><FPCLINE>  FROM lfa1</FPCLINE><FPCLINE>  WHERE lifnr = @header-lifnr.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  gs_hlb-name1 = lv_name1.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- Código interno</FPCLINE><FPCLINE>gs_hlb-lifnr = header-lifnr.</FPCLINE><FPCLINE/><FPCLINE>*--- Calle ciudad y codigo postal</FPCLINE><FPCLINE>SELECT SINGLE b~mc_street, b~city1, b~post_code1</FPCLINE><FPCLINE>  INTO @gs_lfnr_adrc</FPCLINE><FPCLINE>  FROM lfa1 AS a</FPCLINE><FPCLINE>  INNER JOIN adrc AS b</FPCLINE><FPCLINE>  ON b~addrnumber = a~adrnr</FPCLINE><FPCLINE>  WHERE a~lifnr = @header-lifnr.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>*--- calle</FPCLINE><FPCLINE>  gs_hlb-mcstr = gs_lfnr_adrc-mc_street.</FPCLINE><FPCLINE>*--- ciudad - código postal</FPCLINE><FPCLINE>  CONCATENATE gs_lfnr_adrc-city1 '-' gs_lfnr_adrc-post_code1</FPCLINE><FPCLINE>  INTO gs_hlb-cd_cp.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- teléfono</FPCLINE><FPCLINE>SELECT SINGLE telf1</FPCLINE><FPCLINE>  INTO @DATA(lv_telf1)</FPCLINE><FPCLINE>  FROM lfa1</FPCLINE><FPCLINE>  WHERE lifnr = @header-lifnr.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  gs_hlb-telf1 = lv_telf1.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- Nit</FPCLINE><FPCLINE>SELECT SINGLE stcd1</FPCLINE><FPCLINE>  INTO @DATA(lv_stcd1)</FPCLINE><FPCLINE>  FROM lfa1</FPCLINE><FPCLINE>  WHERE lifnr = @header-lifnr.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  gs_hlb-stcd1 = lv_stcd1.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>lv_werks_flag = 0.</FPCLINE><FPCLINE>CLEAR: lv_werks.</FPCLINE><FPCLINE/><FPCLINE>*Modififacion de precio en posiciones EKPO</FPCLINE><FPCLINE>LOOP AT item ASSIGNING FIELD-SYMBOL(&lt;ls_item&gt;).</FPCLINE><FPCLINE>  SELECT SINGLE netpr FROM ekpo INTO &lt;ls_item&gt;-netpr</FPCLINE><FPCLINE>    WHERE ebeln EQ &lt;ls_item&gt;-ebeln</FPCLINE><FPCLINE>      AND ebelp EQ &lt;ls_item&gt;-ebelp.</FPCLINE><FPCLINE>ENDLOOP.</FPCLINE><FPCLINE/><FPCLINE>*--- Posiciones</FPCLINE><FPCLINE>LOOP AT item INTO DATA(ls_item).</FPCLINE><FPCLINE/><FPCLINE>  SELECT SINGLE waers FROM ekko INTO ls_dpos-waers</FPCLINE><FPCLINE>    WHERE ebeln EQ ls_item-ebeln.</FPCLINE><FPCLINE/><FPCLINE>  ls_dpos-ebelp = ls_item-ebelp.</FPCLINE><FPCLINE/><FPCLINE>  ls_dpos-matnr = ls_item-matnr.</FPCLINE><FPCLINE/><FPCLINE>*--- quito ceros a la izquierda al imprimir material</FPCLINE><FPCLINE>  CALL FUNCTION 'CONVERSION_EXIT_ALPHA_OUTPUT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      input  = ls_dpos-matnr</FPCLINE><FPCLINE>    IMPORTING</FPCLINE><FPCLINE>      output = ls_dpos-matnr.</FPCLINE><FPCLINE/><FPCLINE>  ls_dpos-descr = ls_item-txz01.</FPCLINE><FPCLINE/><FPCLINE>*--- busco el texto de la posición de ser el caso se</FPCLINE><FPCLINE>*--- incluye en la descripción</FPCLINE><FPCLINE>  lv_id = 'F01'.</FPCLINE><FPCLINE>  CONCATENATE ls_item-ebeln ls_item-ebelp INTO lv_uniqueid.</FPCLINE><FPCLINE>  lv_name = lv_uniqueid.</FPCLINE><FPCLINE/><FPCLINE>  CLEAR: lt_lines, ls_lines.</FPCLINE><FPCLINE>  CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      client                  = sy-mandt</FPCLINE><FPCLINE>      id                      = lv_id</FPCLINE><FPCLINE>      language                = sy-langu</FPCLINE><FPCLINE>      name                    = lv_name</FPCLINE><FPCLINE>      object                  = 'EKPO'</FPCLINE><FPCLINE>    TABLES</FPCLINE><FPCLINE>      lines                   = lt_lines</FPCLINE><FPCLINE>    EXCEPTIONS</FPCLINE><FPCLINE>      id                      = 1</FPCLINE><FPCLINE>      language                = 2</FPCLINE><FPCLINE>      name                    = 3</FPCLINE><FPCLINE>      not_found               = 4</FPCLINE><FPCLINE>      object                  = 5</FPCLINE><FPCLINE>      reference_check         = 6</FPCLINE><FPCLINE>      wrong_access_to_archive = 7</FPCLINE><FPCLINE>      OTHERS                  = 8.</FPCLINE><FPCLINE>  IF sy-subrc = 0.</FPCLINE><FPCLINE>    LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>      CONCATENATE ls_dpos-descr ls_lines-tdline INTO ls_dpos-descr</FPCLINE><FPCLINE>      SEPARATED BY ' - '.</FPCLINE><FPCLINE>    ENDLOOP.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>*--- busco la orden interna si el tipo de imputación es de orden "F"</FPCLINE><FPCLINE>*  IF ls_item-knttp EQ 'F'.</FPCLINE><FPCLINE>*--- busco orden interna</FPCLINE><FPCLINE>  SELECT SINGLE aufnr</FPCLINE><FPCLINE>    INTO lv_aufnr</FPCLINE><FPCLINE>    FROM ekkn</FPCLINE><FPCLINE>    WHERE ebeln = ls_item-ebeln.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE/><FPCLINE>*--- busco el texto de la orden interna</FPCLINE><FPCLINE>    SELECT SINGLE ktext</FPCLINE><FPCLINE>      INTO lv_ktext</FPCLINE><FPCLINE>      FROM coas</FPCLINE><FPCLINE>      WHERE aufnr = lv_aufnr.</FPCLINE><FPCLINE/><FPCLINE>*--- quito ceros a la izquierda de la orden interna</FPCLINE><FPCLINE>    CALL FUNCTION 'CONVERSION_EXIT_ALPHA_OUTPUT'</FPCLINE><FPCLINE>      EXPORTING</FPCLINE><FPCLINE>        input  = lv_aufnr</FPCLINE><FPCLINE>      IMPORTING</FPCLINE><FPCLINE>        output = lv_aufnr.</FPCLINE><FPCLINE/><FPCLINE>    IF lv_aufnr IS NOT INITIAL.</FPCLINE><FPCLINE>*--- concateno en la descripción el dato de la orden interna</FPCLINE><FPCLINE>      CONCATENATE "ls_dpos-descr ' - '</FPCLINE><FPCLINE>      'Orden Interna' lv_aufnr lv_ktext</FPCLINE><FPCLINE>      INTO ls_dpos-txt_imputa-txt_imputa "ls_dpos-descr</FPCLINE><FPCLINE>      SEPARATED BY ' '.</FPCLINE><FPCLINE/><FPCLINE>      ls_dpos-descr = |{ ls_dpos-descr }| &amp;&amp; cl_abap_char_utilities=&gt;newline &amp;&amp; |{ ls_dpos-txt_imputa-txt_imputa }|.</FPCLINE><FPCLINE/><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ls_dpos-ktmng = ls_item-menge.</FPCLINE><FPCLINE>*--- no se llena montos para cuando la clase es ZCCO</FPCLINE><FPCLINE>  IF header-bsart NE 'ZCCO'. "AND header-bsart NE 'ZMOT'.</FPCLINE><FPCLINE>    ls_dpos-netpr = ls_item-netpr.</FPCLINE><FPCLINE>    ls_dpos-brtwr = ls_item-brtwr.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ls_dpos-werks = ls_item-werks.</FPCLINE><FPCLINE/><FPCLINE>*--- denominación del centro</FPCLINE><FPCLINE>  SELECT SINGLE name2</FPCLINE><FPCLINE>    INTO @DATA(lv_name2)</FPCLINE><FPCLINE>    FROM t001w</FPCLINE><FPCLINE>    WHERE werks = @ls_item-werks.</FPCLINE><FPCLINE>  IF sy-subrc = 0.</FPCLINE><FPCLINE>    ls_dpos-name2 = lv_name2.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- no se llena montos para cuando la clase es ZCCO</FPCLINE><FPCLINE>  IF header-bsart NE 'ZCCO'. "AND header-bsart NE 'ZMOT'.</FPCLINE><FPCLINE>    gv_subtot = gv_subtot + ls_item-brtwr.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>    "   Tomar todo los impuesto, se comenta siguiente linea.</FPCLINE><FPCLINE>*    IF ls_item-mwskz EQ 'V2'. "Para obtner sumatoria iva por posicion.</FPCLINE><FPCLINE>    IF ls_item-mwskz IS NOT INITIAL.</FPCLINE><FPCLINE>*--- se busca el porcentaje de impuesto a aplicar</FPCLINE><FPCLINE>      PERFORM f_get_tax USING ls_item-mwskz CHANGING lv_kbetr.</FPCLINE><FPCLINE/><FPCLINE>*--- se convierte de porcentaje a monto y acumula el monto del iva</FPCLINE><FPCLINE>*--- aplicado al monto</FPCLINE><FPCLINE>      gv_iva = gv_iva + ( ls_item-brtwr * ( lv_kbetr / 10 ) ) / 100.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  IF lv_werks_flag = 0.</FPCLINE><FPCLINE>    lv_werks_flag = 1.</FPCLINE><FPCLINE>  ELSE.</FPCLINE><FPCLINE>    IF lv_werks &lt;&gt; ls_dpos-werks.</FPCLINE><FPCLINE>      lv_werks_flag = 2.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  lv_werks = ls_dpos-werks.</FPCLINE><FPCLINE/><FPCLINE>  APPEND ls_dpos TO gt_dpos.</FPCLINE><FPCLINE>ENDLOOP.</FPCLINE><FPCLINE/><FPCLINE>*Timbre de prensa</FPCLINE><FPCLINE>SELECT SINGLE knumv FROM ekko INTO @DATA(lv_knumv)</FPCLINE><FPCLINE>  WHERE ebeln EQ @header-ebeln.</FPCLINE><FPCLINE>IF sy-subrc EQ 0.</FPCLINE><FPCLINE>  SELECT SUM( kwert ) FROM prcd_elements INTO gv_timbre</FPCLINE><FPCLINE>    WHERE knumv = lv_knumv</FPCLINE><FPCLINE>      AND kschl = 'ZTPR'.</FPCLINE><FPCLINE>  IF gv_timbre IS INITIAL.</FPCLINE><FPCLINE>    gv_timbre = 0.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>*Total</FPCLINE><FPCLINE>gv_total = gv_subtot + gv_iva + gv_timbre.</FPCLINE><FPCLINE/><FPCLINE>*--- no se llena montos para cuando la clase es ZCCO</FPCLINE><FPCLINE>*IF HEADER-BSART NE 'ZCCO' AND HEADER-BSART NE 'ZMOT'.</FPCLINE><FPCLINE>*</FPCLINE><FPCLINE>**--- se busca el monto iva</FPCLINE><FPCLINE>*  SELECT SUM( KWERT )</FPCLINE><FPCLINE>*    INTO GV_IVA</FPCLINE><FPCLINE>*    FROM PRCD_ELEMENTS</FPCLINE><FPCLINE>*    WHERE KNUMV = HEADER-KNUMV AND</FPCLINE><FPCLINE>*          KSCHL = 'MVST'.</FPCLINE><FPCLINE>*</FPCLINE><FPCLINE>*  GV_TOTAL = GV_SUBTOT + GV_IVA.</FPCLINE><FPCLINE>*ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- Observaciones</FPCLINE><FPCLINE>lv_id = 'F01'.</FPCLINE><FPCLINE>lv_name = header-ebeln.</FPCLINE><FPCLINE/><FPCLINE>CLEAR: lt_lines, ls_lines.</FPCLINE><FPCLINE>CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>  EXPORTING</FPCLINE><FPCLINE>    client                  = sy-mandt</FPCLINE><FPCLINE>    id                      = lv_id</FPCLINE><FPCLINE>    language                = sy-langu</FPCLINE><FPCLINE>    name                    = lv_name</FPCLINE><FPCLINE>    object                  = 'EKKO'</FPCLINE><FPCLINE>  TABLES</FPCLINE><FPCLINE>    lines                   = lt_lines</FPCLINE><FPCLINE>  EXCEPTIONS</FPCLINE><FPCLINE>    id                      = 1</FPCLINE><FPCLINE>    language                = 2</FPCLINE><FPCLINE>    name                    = 3</FPCLINE><FPCLINE>    not_found               = 4</FPCLINE><FPCLINE>    object                  = 5</FPCLINE><FPCLINE>    reference_check         = 6</FPCLINE><FPCLINE>    wrong_access_to_archive = 7</FPCLINE><FPCLINE>    OTHERS                  = 8.</FPCLINE><FPCLINE>IF sy-subrc = 0.</FPCLINE><FPCLINE>  LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>* READ TABLE LT_LINES INTO LS_LINES INDEX 1.</FPCLINE><FPCLINE>    CONCATENATE gv_obsrv ls_lines-tdline INTO gv_obsrv SEPARATED BY ' '.</FPCLINE><FPCLINE>* GV_OBSRV =  LS_LINES-TDLINE.</FPCLINE><FPCLINE>  ENDLOOP.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- dirección de entrega</FPCLINE><FPCLINE>*SELECT SINGLE name2</FPCLINE><FPCLINE>*  INTO gs_dir_ent-name2</FPCLINE><FPCLINE>*  FROM t001w</FPCLINE><FPCLINE>*  WHERE werks = ls_item-werks.</FPCLINE><FPCLINE>*  gs_dir_ent-street = gs_adrc-street.</FPCLINE><FPCLINE/><FPCLINE>SELECT SINGLE * FROM t001w INTO @DATA(ls_dir_ent)</FPCLINE><FPCLINE>  WHERE werks = @ls_item-werks.</FPCLINE><FPCLINE>IF sy-subrc EQ 0.</FPCLINE><FPCLINE>  SELECT SINGLE * FROM adrc INTO @DATA(ls_adrc)</FPCLINE><FPCLINE>    WHERE addrnumber EQ @ls_dir_ent-adrnr.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>gs_dir_ent-street = ls_adrc-street.</FPCLINE><FPCLINE/><FPCLINE>IF lv_werks_flag = 2.</FPCLINE><FPCLINE>  gs_dir_ent-street = 'Las entregas se hará según directorio actualizado proporcionado por Distelsa'.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- datos de facturación</FPCLINE><FPCLINE>*--- obtengo los datos de facturación con sociedad sin</FPCLINE><FPCLINE>*--- tomar en cuenta la excepción que tiene los datos</FPCLINE><FPCLINE>*--- de la empresa</FPCLINE><FPCLINE>CLEAR: gs_t001, gs_adrc, gv_paval.</FPCLINE><FPCLINE>PERFORM f_get_dat_emp USING header-bukrs</FPCLINE><FPCLINE>                   CHANGING gs_t001 gs_adrc gv_paval.</FPCLINE><FPCLINE/><FPCLINE>gs_fact_dat-butxt = |{ gs_adrc-name1 } { space } { gs_adrc-name2 }|.</FPCLINE><FPCLINE>gs_fact_dat-street = gs_adrc-street.</FPCLINE><FPCLINE>gs_fact_dat-paval = gv_paval.</FPCLINE><FPCLINE/><FPCLINE>*--- notas importantes</FPCLINE><FPCLINE>IF header-bsart NE 'ZCCO'. "AND header-bsart NE 'ZMOT'.</FPCLINE><FPCLINE>*--- titulo</FPCLINE><FPCLINE>  gv_notas_imp_ttl = 'NOTAS IMPORTANTES'.</FPCLINE><FPCLINE>*--- las notas</FPCLINE><FPCLINE>*--- 1 anticorrupción</FPCLINE><FPCLINE>  CLEAR: lt_lines, ls_lines.</FPCLINE><FPCLINE>  CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      client                  = sy-mandt</FPCLINE><FPCLINE>      id                      = 'ST'</FPCLINE><FPCLINE>      language                = sy-langu</FPCLINE><FPCLINE>      name                    = 'ANTICORRUPCION'</FPCLINE><FPCLINE>      object                  = 'TEXT'</FPCLINE><FPCLINE>    TABLES</FPCLINE><FPCLINE>      lines                   = lt_lines</FPCLINE><FPCLINE>    EXCEPTIONS</FPCLINE><FPCLINE>      id                      = 1</FPCLINE><FPCLINE>      language                = 2</FPCLINE><FPCLINE>      name                    = 3</FPCLINE><FPCLINE>      not_found               = 4</FPCLINE><FPCLINE>      object                  = 5</FPCLINE><FPCLINE>      reference_check         = 6</FPCLINE><FPCLINE>      wrong_access_to_archive = 7</FPCLINE><FPCLINE>      OTHERS                  = 8.</FPCLINE><FPCLINE>  IF sy-subrc = 0.</FPCLINE><FPCLINE>    LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>      IF ls_lines-tdline EQ ''.</FPCLINE><FPCLINE>        CONTINUE.</FPCLINE><FPCLINE>      ELSE.</FPCLINE><FPCLINE>        CONCATENATE gv_anticor ls_lines-tdline INTO gv_anticor</FPCLINE><FPCLINE>        SEPARATED BY space.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>    ENDLOOP.</FPCLINE><FPCLINE>    "    CONCATENATE gv_anticor cl_abap_char_utilities=&gt;cr_lf INTO gv_anticor.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE/><FPCLINE>*--- 2 Cumplimiento tributario</FPCLINE><FPCLINE>  CLEAR: lt_lines, ls_lines.</FPCLINE><FPCLINE>  CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      client                  = sy-mandt</FPCLINE><FPCLINE>      id                      = 'ST'</FPCLINE><FPCLINE>      language                = sy-langu</FPCLINE><FPCLINE>      name                    = 'CUMPLIMIENTO_TRIBUTARIO'</FPCLINE><FPCLINE>      object                  = 'TEXT'</FPCLINE><FPCLINE>    TABLES</FPCLINE><FPCLINE>      lines                   = lt_lines</FPCLINE><FPCLINE>    EXCEPTIONS</FPCLINE><FPCLINE>      id                      = 1</FPCLINE><FPCLINE>      language                = 2</FPCLINE><FPCLINE>      name                    = 3</FPCLINE><FPCLINE>      not_found               = 4</FPCLINE><FPCLINE>      object                  = 5</FPCLINE><FPCLINE>      reference_check         = 6</FPCLINE><FPCLINE>      wrong_access_to_archive = 7</FPCLINE><FPCLINE>      OTHERS                  = 8.</FPCLINE><FPCLINE>  IF sy-subrc = 0.</FPCLINE><FPCLINE>    LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>      IF ls_lines-tdline EQ ''.</FPCLINE><FPCLINE>        CONTINUE.</FPCLINE><FPCLINE>      ELSE.</FPCLINE><FPCLINE>        CONCATENATE gv_cumplim ls_lines-tdline INTO gv_cumplim</FPCLINE><FPCLINE>        SEPARATED BY space.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>    ENDLOOP.</FPCLINE><FPCLINE>    "    CONCATENATE gv_cumplim cl_abap_char_utilities=&gt;cr_lf INTO gv_cumplim.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE/><FPCLINE>*--- 3 Aceptación</FPCLINE><FPCLINE>  CLEAR: lt_lines, ls_lines.</FPCLINE><FPCLINE>  CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      client                  = sy-mandt</FPCLINE><FPCLINE>      id                      = 'ST'</FPCLINE><FPCLINE>      language                = sy-langu</FPCLINE><FPCLINE>      name                    = 'ACEPTACION'</FPCLINE><FPCLINE>      object                  = 'TEXT'</FPCLINE><FPCLINE>    TABLES</FPCLINE><FPCLINE>      lines                   = lt_lines</FPCLINE><FPCLINE>    EXCEPTIONS</FPCLINE><FPCLINE>      id                      = 1</FPCLINE><FPCLINE>      language                = 2</FPCLINE><FPCLINE>      name                    = 3</FPCLINE><FPCLINE>      not_found               = 4</FPCLINE><FPCLINE>      object                  = 5</FPCLINE><FPCLINE>      reference_check         = 6</FPCLINE><FPCLINE>      wrong_access_to_archive = 7</FPCLINE><FPCLINE>      OTHERS                  = 8.</FPCLINE><FPCLINE>  IF sy-subrc = 0.</FPCLINE><FPCLINE>    LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>      IF ls_lines-tdline EQ ''.</FPCLINE><FPCLINE>        CONTINUE.</FPCLINE><FPCLINE>      ELSE.</FPCLINE><FPCLINE>        CONCATENATE gv_aceptac ls_lines-tdline INTO gv_aceptac</FPCLINE><FPCLINE>        SEPARATED BY space.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>    ENDLOOP.</FPCLINE><FPCLINE>    "   CONCATENATE gv_aceptac cl_abap_char_utilities=&gt;cr_lf INTO gv_aceptac.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>ELSE.</FPCLINE><FPCLINE>*--- titulo</FPCLINE><FPCLINE>  gv_notas_imp_ttl = 'NOTAS IMPORTANTES'.</FPCLINE><FPCLINE>*--- las notas</FPCLINE><FPCLINE>*--- Categorias</FPCLINE><FPCLINE>  CLEAR: lt_lines, ls_lines.</FPCLINE><FPCLINE>  CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>    EXPORTING</FPCLINE><FPCLINE>      client                  = sy-mandt</FPCLINE><FPCLINE>      id                      = 'ST'</FPCLINE><FPCLINE>      language                = sy-langu</FPCLINE><FPCLINE>      name                    = 'CATEGORIAS'</FPCLINE><FPCLINE>      object                  = 'TEXT'</FPCLINE><FPCLINE>    TABLES</FPCLINE><FPCLINE>      lines                   = lt_lines</FPCLINE><FPCLINE>    EXCEPTIONS</FPCLINE><FPCLINE>      id                      = 1</FPCLINE><FPCLINE>      language                = 2</FPCLINE><FPCLINE>      name                    = 3</FPCLINE><FPCLINE>      not_found               = 4</FPCLINE><FPCLINE>      object                  = 5</FPCLINE><FPCLINE>      reference_check         = 6</FPCLINE><FPCLINE>      wrong_access_to_archive = 7</FPCLINE><FPCLINE>      OTHERS                  = 8.</FPCLINE><FPCLINE>  IF sy-subrc = 0.</FPCLINE><FPCLINE>    LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>      IF ls_lines-tdline EQ ''.</FPCLINE><FPCLINE>        CONTINUE.</FPCLINE><FPCLINE>      ELSE.</FPCLINE><FPCLINE>        CONCATENATE gv_anticor ls_lines-tdline INTO gv_anticor</FPCLINE><FPCLINE>        SEPARATED BY space.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>    ENDLOOP.</FPCLINE><FPCLINE>    "    CONCATENATE gv_anticor cl_abap_char_utilities=&gt;cr_lf INTO gv_anticor.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>*--- busco el usuario que elaboro el pedido</FPCLINE><FPCLINE>*BREAK vmuñoz.</FPCLINE><FPCLINE>SELECT SINGLE name_text</FPCLINE><FPCLINE>  INTO gv_ernam</FPCLINE><FPCLINE>  FROM user_addrp</FPCLINE><FPCLINE> WHERE bname = header-ernam.</FPCLINE><FPCLINE>*gv_ernam = sy-uname.</FPCLINE><FPCLINE/><FPCLINE>*--- usuario que autorizo el pedido</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE/><FPCLINE/><FPCLINE>*BREAK gmolina.</FPCLINE><FPCLINE>IF header-ebeln IS NOT INITIAL.</FPCLINE><FPCLINE/><FPCLINE>  REFRESH: lt_lines.</FPCLINE><FPCLINE>  CLEAR: ls_lines.</FPCLINE><FPCLINE/><FPCLINE>  SELECT SINGLE * FROM stxh INTO @DATA(ls_stxh)</FPCLINE><FPCLINE>    WHERE tdname   EQ @header-ebeln</FPCLINE><FPCLINE>      AND tdobject EQ 'EKKO'</FPCLINE><FPCLINE>      AND tdid     EQ 'F01'.</FPCLINE><FPCLINE/><FPCLINE>  IF ls_stxh-tdname IS NOT INITIAL.</FPCLINE><FPCLINE>    CALL FUNCTION 'READ_TEXT'</FPCLINE><FPCLINE>      EXPORTING</FPCLINE><FPCLINE>        id       = ls_stxh-tdid</FPCLINE><FPCLINE>        language = ls_stxh-tdspras</FPCLINE><FPCLINE>        name     = ls_stxh-tdname</FPCLINE><FPCLINE>        object   = ls_stxh-tdobject</FPCLINE><FPCLINE>      TABLES</FPCLINE><FPCLINE>        lines    = lt_lines.</FPCLINE><FPCLINE/><FPCLINE>    LOOP AT lt_lines INTO ls_lines.</FPCLINE><FPCLINE>      IF sy-subrc EQ 0.</FPCLINE><FPCLINE>        CONCATENATE gv_obs ls_lines-tdline INTO gv_obs SEPARATED BY space.</FPCLINE><FPCLINE>        CONDENSE gv_obs.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE>    ENDLOOP.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>*Firma autorizador</FPCLINE><FPCLINE>RANGES: lr_text FOR swwwihead-wi_text.</FPCLINE><FPCLINE/><FPCLINE>lr_text-sign = 'I'.       " Include</FPCLINE><FPCLINE>lr_text-option = 'CP'.    " Contains Pattern</FPCLINE><FPCLINE>CONCATENATE '*' header-ebeln '*' INTO lr_text-low. "header-ebeln</FPCLINE><FPCLINE>APPEND lr_text.</FPCLINE><FPCLINE/><FPCLINE>SELECT SINGLE * FROM swwwihead INTO @DATA(ls_ihead)</FPCLINE><FPCLINE>  WHERE wi_type EQ 'W'</FPCLINE><FPCLINE>    AND wi_stat EQ 'COMPLETED'</FPCLINE><FPCLINE>    AND wi_rh_task EQ 'TS00800531'</FPCLINE><FPCLINE>    AND wi_text IN @lr_text.</FPCLINE><FPCLINE>IF sy-subrc EQ 0.</FPCLINE><FPCLINE>  SELECT SINGLE * FROM usr21 INTO @DATA(ls_usr21)</FPCLINE><FPCLINE>    WHERE bname  EQ @ls_ihead-wi_aagent.</FPCLINE><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    SELECT SINGLE * FROM adrp INTO @DATA(ls_adrp)</FPCLINE><FPCLINE>      WHERE persnumber  EQ @ls_usr21-persnumber.</FPCLINE><FPCLINE>    IF sy-subrc EQ 0.</FPCLINE><FPCLINE>      gv_autorizador = ls_adrp-name_text.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE>  ENDIF.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>IF gv_autorizador IS INITIAL.</FPCLINE><FPCLINE>  gv_autorizador = 'Pedido Liberado Automáticamente'.</FPCLINE><FPCLINE>ENDIF.</FPCLINE></INITIALIZATION><FORMS><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>*&amp; Form F_GET_DAT_EMP</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>*&amp; text</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>*&amp;      --&gt; LV_BUKRS</FPCLINE><FPCLINE>*&amp;      &lt;-- GS_T001</FPCLINE><FPCLINE>*&amp;      &lt;-- GS_ADRC</FPCLINE><FPCLINE>*&amp;      &lt;-- GV_PAVAL</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>FORM F_GET_DAT_EMP  USING    PV_BUKRS</FPCLINE><FPCLINE>                    CHANGING PS_T001 TYPE TY_T001</FPCLINE><FPCLINE>                             PS_ADRC TYPE TY_ADRC</FPCLINE><FPCLINE>                             PV_PAVAL TYPE PAVAL.</FPCLINE><FPCLINE/><FPCLINE>*--- Se buscan datos de la empresa</FPCLINE><FPCLINE>SELECT SINGLE BUTXT ADRNR ORT01</FPCLINE><FPCLINE>  INTO PS_T001</FPCLINE><FPCLINE>  FROM T001</FPCLINE><FPCLINE>  WHERE BUKRS EQ PV_BUKRS.</FPCLINE><FPCLINE/><FPCLINE>*--- Se buscan datos de direccion</FPCLINE><FPCLINE>SELECT SINGLE STREET TEL_NUMBER NAME1 NAME2</FPCLINE><FPCLINE>  INTO PS_ADRC</FPCLINE><FPCLINE>  FROM ADRC</FPCLINE><FPCLINE>  WHERE ADDRNUMBER EQ PS_T001-ADRNR.</FPCLINE><FPCLINE/><FPCLINE>*---Se obtiene el NIT</FPCLINE><FPCLINE>SELECT SINGLE PAVAL</FPCLINE><FPCLINE>  INTO GV_PAVAL</FPCLINE><FPCLINE>  FROM T001Z</FPCLINE><FPCLINE>  WHERE BUKRS EQ PV_BUKRS.</FPCLINE><FPCLINE>ENDFORM.</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>*&amp; Form F_GET_TAX</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>*&amp; text</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>*&amp;      --&gt; LS_ITEM_MWSKZ</FPCLINE><FPCLINE>*&amp;      &lt;-- LV_KBETR</FPCLINE><FPCLINE>*&amp;---------------------------------------------------------------------*</FPCLINE><FPCLINE>FORM F_GET_TAX  USING    P_MWSKZ</FPCLINE><FPCLINE>                CHANGING P_KBETR.</FPCLINE><FPCLINE/><FPCLINE>*--- tablas</FPCLINE><FPCLINE>DATA: LT_FTAXP TYPE STANDARD TABLE OF FTAXP. "</FPCLINE><FPCLINE/><FPCLINE>*--- estructuras</FPCLINE><FPCLINE>DATA: LS_FTAXP  LIKE LINE OF LT_FTAXP.</FPCLINE><FPCLINE/><FPCLINE>*--- variables</FPCLINE><FPCLINE>DATA: LV_ALAND  TYPE RF82T-LAND1, "</FPCLINE><FPCLINE>      LV_DATAB  TYPE RF82T-DATAB, "</FPCLINE><FPCLINE>      LV_MWSKZ  TYPE RF82T-MWSKZ, "</FPCLINE><FPCLINE>      LV_TXJCD  TYPE RF82T-TXJCD, "</FPCLINE><FPCLINE>      LV_EXPORT TYPE XFELD.        "   SPACE</FPCLINE><FPCLINE/><FPCLINE>LV_ALAND = 'GT'.</FPCLINE><FPCLINE>LV_DATAB = SY-DATUM.</FPCLINE><FPCLINE>LV_MWSKZ = P_MWSKZ.</FPCLINE><FPCLINE>LV_TXJCD = 'ZTXGGT'.</FPCLINE><FPCLINE/><FPCLINE>*--- obtengo el porcentaje de impuesto</FPCLINE><FPCLINE>CALL FUNCTION 'GET_TAX_PERCENTAGE'  "</FPCLINE><FPCLINE>  EXPORTING</FPCLINE><FPCLINE>    ALAND   = LV_ALAND</FPCLINE><FPCLINE>    DATAB   = LV_DATAB</FPCLINE><FPCLINE>    MWSKZ   = LV_MWSKZ</FPCLINE><FPCLINE>    TXJCD   = LV_TXJCD</FPCLINE><FPCLINE>    EXPORT  = LV_EXPORT</FPCLINE><FPCLINE>  TABLES</FPCLINE><FPCLINE>    T_FTAXP = LT_FTAXP.     "GET_TAX_PERCENTAGE</FPCLINE><FPCLINE/><FPCLINE>READ TABLE LT_FTAXP INTO LS_FTAXP WITH KEY KSCHL = 'MWVS'.</FPCLINE><FPCLINE>IF SY-SUBRC = 0.</FPCLINE><FPCLINE>  P_KBETR = LS_FTAXP-KBETR.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>ENDFORM.</FPCLINE></FORMS></CL_FP_CODING></cls:CL_FP_CODING></asx:heap></asx:abap>